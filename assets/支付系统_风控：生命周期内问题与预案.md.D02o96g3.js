import{_ as i,c as e,o as l,a1 as r}from"./chunks/framework.CPsxJxQM.js";const u=JSON.parse('{"title":"风控：生命周期内问题与预案","description":"","frontmatter":{},"headers":[],"relativePath":"支付系统/风控：生命周期内问题与预案.md","filePath":"支付系统/风控：生命周期内问题与预案.md"}'),t={name:"支付系统/风控：生命周期内问题与预案.md"};function h(o,a,s,p,d,n){return l(),e("div",null,a[0]||(a[0]=[r('<h1 id="风控-生命周期内问题与预案" tabindex="-1">风控：生命周期内问题与预案 <a class="header-anchor" href="#风控-生命周期内问题与预案" aria-label="Permalink to &quot;风控：生命周期内问题与预案&quot;">​</a></h1><h2 id="事前-预先分析" tabindex="-1">事前：预先分析 <a class="header-anchor" href="#事前-预先分析" aria-label="Permalink to &quot;事前：预先分析&quot;">​</a></h2><ul><li>进件商户调查；平台对进件商户资质、业务、交易额合理性进行初筛</li><li>用户黑名单；分析交易行为，确定风险用户并加黑</li></ul><h2 id="事中-实时分析" tabindex="-1">事中：实时分析 <a class="header-anchor" href="#事中-实时分析" aria-label="Permalink to &quot;事中：实时分析&quot;">​</a></h2><h3 id="业务风控模型-经事后数据建立模型-反哺" tabindex="-1">业务风控模型：经事后数据建立模型&amp;反哺 <a class="header-anchor" href="#业务风控模型-经事后数据建立模型-反哺" aria-label="Permalink to &quot;业务风控模型：经事后数据建立模型&amp;反哺&quot;">​</a></h3><p>业务不合理性分析 加油业务，加#92汽油 8000元，此交易就存在风险。与实际不符合。 加油业务，一天加七八回油，情况较少，存在隐患 解决：梯度告警 &amp; 限制，一段时间或不限时间 ，第一次告警，第n次限制。</p><h3 id="刷单、代付识别" tabindex="-1">刷单、代付识别 <a class="header-anchor" href="#刷单、代付识别" aria-label="Permalink to &quot;刷单、代付识别&quot;">​</a></h3><ul><li>多个平台账号共用一个支付账户(支付宝/微信)：涉嫌刷单</li><li>一个平台账号，频繁使用多个支付账户进行支付(可留存用户的三方通道身份)</li><li>解决：下单时加限制条件，超限后不可继续支付。</li></ul><h3 id="盗链识别与定位" tabindex="-1">盗链识别与定位 <a class="header-anchor" href="#盗链识别与定位" aria-label="Permalink to &quot;盗链识别与定位&quot;">​</a></h3><ul><li><p>盗链监控：</p></li><li><p>通过账号监控；一个平台账号，使用多个支付账号(微信/支付宝)，因为需要诈骗不同的用户</p></li><li><p>通过埋点监控(间连scheme)；下单生产scheme时埋点用户ip，打开小程序后请求支付下单时埋点用户ip，做对比or监控</p></li><li><p>通过单量异常监控；部分油站、渠道的订单量突增，可能是盗链。</p></li><li><p>通过用户上下文埋点监控</p></li><li><p>盗链场景：订单下单与支付操作的用户身份不一致，常用于欺诈。例如不法分子代下订单，但支付由他人完成，形成“跳单”或“钓鱼式支付”。</p></li><li><p>解决：下单时采集用户唯一标识（ip、id等）,与支付时的环境进行对比。</p></li><li><p>盗链场景：微信程序scheme间连（核心难点）</p></li><li><p>解决：生产scheme时，缓存单据与用户身份（IP、id、设备信息）的关系。用户支付时，让前端获取用户ip并传递到间连支付接口。进行校验。</p></li></ul><p>防盗链的前提：支付串或拉起支付的参数，要与用户身份绑定(ip、id、设备等)，然后加密混淆 客户端验证用户是否盗链：后端吐支付串 + 用户身份的密文，但是容易被破解。盗链者只需要拿到scheme就能支付。 用户身份使用ip 服务端返回 下单时ip + 支付串/scheme；盗链者只需要破解ip加密逻辑，篡改ip，破解sign计算逻辑，即可伪造userid，拿到scheme。 用户身份使用userid 服务端返回 userid + 支付串/scheme；盗链者只需要破解userid加密逻辑，篡改userid，破解sign计算逻辑，即可伪造userid，拿到scheme。 服务端验证用户是否盗链：用户请求scheme之后，需要访问支付服务去通道下单，此时获取用户身份。 用户身份使用ip 请求通道前获取ip，与用户下单时的做比较 校验用户平均支付时间，做分组，分析是否有支付时间突增的情况（下单到实际支付），排除掉部分场景。</p><h3 id="手机丢失导致支付账户被盗用" tabindex="-1">手机丢失导致支付账户被盗用 <a class="header-anchor" href="#手机丢失导致支付账户被盗用" aria-label="Permalink to &quot;手机丢失导致支付账户被盗用&quot;">​</a></h3><ul><li>异常地理位置；IP/基站位置突然变化，与历史行为不一致</li><li>连续多笔小额支付；模拟“薅羊毛”或逐笔转移资金</li><li>非常规时间段支付；深夜、清晨操作等异常行为时间</li></ul><h3 id="透支、欠费拖欠" tabindex="-1">透支、欠费拖欠 <a class="header-anchor" href="#透支、欠费拖欠" aria-label="Permalink to &quot;透支、欠费拖欠&quot;">​</a></h3><ul><li>限额策略 + 欠费黑名单</li></ul><h2 id="事后-风险模型建设" tabindex="-1">事后：风险模型建设 <a class="header-anchor" href="#事后-风险模型建设" aria-label="Permalink to &quot;事后：风险模型建设&quot;">​</a></h2><ul><li>行为分析、风控模型建立、反哺事前、事中规则。</li><li>数据分析挖掘、 事故原因定位、 一键冻结账户</li></ul><p>个体风险识别模型主要用于针对个体账户、身份证、IP、设备等信息进行风险识别，以防止盗卡、盗号、防刷等风险事件的发生。 群体识别模型主要应用于薅羊毛、批量盗号、团伙洗钱等风险场景，其特点是呈现群体特性。</p>',18)]))}const _=i(t,[["render",h]]);export{u as __pageData,_ as default};

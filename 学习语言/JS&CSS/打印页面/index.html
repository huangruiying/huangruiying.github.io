<html>
<head>
</head>

<body>
<style>
    .single_header {
        height: 60px;
        background-color: #656565;
    }

    .single_header td {
        color: #333;
        font-size: 16px;
        padding-left: 6px;
    }

</style>
<div style="width:100%;height:100%;overflow:auto;">
    <table id='invoice.check.single.view.form' class="single_header" cellspacing=0 cellpadding="4">
        <tr style="">

            <td>IE浏览器打印整个页面</td>

            <td>查验时间:
                <span id="invoice.check.single.view.form.lastCheckDate"></span>
            </td>
            <td>4214134</td>
            <td>&3er1f;</td>
            <td>&nbsp;</td>
            <td>&4234t;</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>

            <td><OBJECT id='WebBrowser' classid=CLSID:8856F961-340A-11D0-A96B-00C04FD705A2 height='0'
                        width='0'></OBJECT></td>
            <td><input type='button' value='打印' onclick='func_print_page(this)'></td>
            <td><input type='button' value='直接打印' onclick='func_print_page(this)'></td>
            <td><input type='button' value='页面设置' onclick='func_print_page(this)'></td>
            <td><input type='button' value='打印预览' onclick='func_print_page(this)'></td>

        </tr>
    </table>



    <!--打印指定区域-->
    <table style="width: 803px" height="100%" id="outCon" style="">
        <tr>
            <td id='print-area' style="padding: 0px;" valign="top">
                <style>
                    div {
                        color: red
                    }
                </style>
                <div>打印指定区域</div>
            </td>
            <td>
                <input type='button' value='打印指定区域' onclick='func_print_area()'/>
            </td>
        </tr>
    </table>
    <div onclick='openWindow()'>open</div>
    <div onclick='closeOpenedWindow()'>close</div>
</div>

<script type='text/javascript'>

    //打印整个页面 IE
    function func_print_page(obj) {
        var type = obj.value;

        if (type === '打印') {
            //下载pdf
            document.all.WebBrowser.ExecWB(6, 1);
        }
        if (type === '直接打印') {
            //直接调用打印机
            document.all.WebBrowser.ExecWB(6, 6);
        }
        if (type === '页面设置') {
            //页面设置
            document.all.WebBrowser.ExecWB(8, 1);
        }
        if (type === '打印预览') {
            //打印预览
            document.all.WebBrowser.ExecWB(7, 1);
        }
    }


    //打印指定区域
    function func_print_area() {
        // 待打印的区域
        var printArea = "print-area";

        //1.对旧页面记录
        var old_ = document.body.innerHTML;
        //2.对新页面记录
        var new_ = document.getElementById(printArea).innerHTML;
        //3.新页面构建
        var headhtml = '<html><head></head><body>';
        var foothtml = '</body></html>';
        new_ = headhtml + new_ + foothtml;
        //4.新页面覆盖
        document.body.innerHTML = new_;
        //5.打印
        window.print();
        //6.还原页面
        document.body.innerHTML = old_;

    }


    var openedWindow;

    // 打开一个tab 加载指定页面/地址
    function openWindow() {
        openedWindow = window.open('moreinfo.htm');
    }

    // 关闭tab
    function closeOpenedWindow() {
        openedWindow.close();
    }

</script>
</body>
</html>
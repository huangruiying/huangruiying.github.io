<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Grafana on 博客</title>
    <link>https://huangruiying.github.io/tags/grafana/</link>
    <description>Recent content in Grafana on 博客</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh</language>
    <lastBuildDate>Mon, 18 Mar 2024 16:45:40 +0800</lastBuildDate><atom:link href="https://huangruiying.github.io/tags/grafana/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Grafana教程 - 数据打点与上报</title>
      <link>https://huangruiying.github.io/%E5%BC%80%E6%BA%90%E8%BD%AF%E4%BB%B6/grafana-%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/%E6%95%B0%E6%8D%AE%E6%89%93%E7%82%B9%E4%B8%8E%E4%B8%8A%E6%8A%A5/</link>
      <pubDate>Mon, 18 Mar 2024 16:45:40 +0800</pubDate>
      
      <guid>https://huangruiying.github.io/%E5%BC%80%E6%BA%90%E8%BD%AF%E4%BB%B6/grafana-%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/%E6%95%B0%E6%8D%AE%E6%89%93%E7%82%B9%E4%B8%8E%E4%B8%8A%E6%8A%A5/</guid>
      <description>数据上报 上报多数据 // 以该种格式上报数据后，时序数据库会多 payType tradeType url 这三列 Map&amp;lt;String, String&amp;gt; tag = Maps.newHashMap(); tag.put(&amp;#34;payType&amp;#34;, String.valueOf(payDetail.getPayType())); tag.put(&amp;#34;tradeType&amp;#34;, String.valueOf(payDetail.getTradeType())); tag.put(&amp;#34;url&amp;#34;, &amp;#34;/services/url/target&amp;#34;); 异常打点 Monitor.recordMany(&amp;ldquo;aggregation_pay_error&amp;rdquo;,1,tagMap);
耗时打点 Stopwatch stopwatch = Stopwatch.createStarted(); Monitor.recordTime(&amp;ldquo;aggregation_pay&amp;rdquo;, stopwatch.elapsed(TimeUnit.MILLISECONDS), tagMap);
查询上报数据 根据 payType tradeType avg by(payType,tradeType) (aggregation_pay{tradeType!=&amp;ldquo;sc&amp;rdquo;,name=&amp;ldquo;payws&amp;rdquo;,quantile=&amp;ldquo;0.95&amp;rdquo;})
耗时配置 avg by(payType,tradeType) (union_pay{tradeType!=&amp;ldquo;sc&amp;rdquo;,name=&amp;ldquo;payws&amp;rdquo;,quantile=&amp;ldquo;0.95&amp;rdquo;})
每分钟流量 sum by(payType) (rate(settlement_req_failed_count{name=&amp;ldquo;payws&amp;rdquo;}[1m]))</description>
    </item>
    
  </channel>
</rss>
